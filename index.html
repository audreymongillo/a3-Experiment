<!DOCTYPE html>
<html>
<head>
    <title>D3 : Random Number Generation - Column Chart</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" charset="utf-8"></script>
    <style type="text/css">
        #chartholder {
            height: 400px;
            width: 600px;
            /*outline the left and bottom edges of the chart*/
            border-left: 1px solid black;
            border-bottom: 1px solid black;
            position: relative;
            display:flex; 
            justify-content: flex-start; 
            flex-direction: row; /*(makes a stacked bar chart somehow)*/
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .bar {
            width: 25px;
            margin-left: 3px;
            background-color: white; /* White fill for D3 bars */
            border: 3px solid black; /* Black outline for D3 bars */
            bottom: 0;
        }


    </style>
</head>
<body>
    <div id="chartholderholder">
        <div id="chartholder"></div>
    </div>

<script type="text/javascript">
    // Random Dataset Method 1 (Manual Random Number Generation)
    var data1 = [0.27, 0.5, 0.1, 0.15, 0.3, 0.21, 0.25, 0.94, 0.04, 1.00];

    // Random Dataset Method 2 (JavaScript Random Number Generation)
    var data2 = [];
    for (var i = 0; i < 10; i++) {
        var newNumber = Math.random();
        data2.push(newNumber);
    }

    // Random Dataset Method 3 (D3 Random Number Generation)
    var data3 = d3.range(10).map(function() {
        return Math.random();
    });

    // Concatinate the 3 Random Datasets
    var data = data1.concat(data2, data2);
    console.log(data);

    data = data2;

    // Generate two unique random indices
    let index1 = Math.floor(Math.random() * data.length);
    let index2 = Math.floor(Math.random() * data.length);

    while(index1 === index2) {
        index2 = Math.floor(Math.random() * data.length);
    }

    // Display a simple Column Chart using the above Random Data
    var svg = d3.select('#chartholder').selectAll('div')
        .data(data)
        .enter()
        .append('div')
        .attr('class', 'bar')
        .style('fill', '#ffffff')
        .style('height', function (d) {
            return d * 400 + 'px';
        })
    
        .each(function(d, i) {
        // Append circles to the randomly chosen bars
            if (i === index1 || i === index2) {
                let bar = d3.select(this);
                let barWidth = parseInt(bar.style('width'));
                let barHeight = parseInt(bar.style('height'));

                bar.append('svg')
                    .attr('width', barWidth)
                    .attr('height', barHeight)
                    .append('circle')
                    .attr('class', 'circle')
                    .attr('r', 4)
                    .attr('cx', barWidth / 2)
                    .attr('cy', barHeight - 15)
                    .style('fill', 'black');
            }
        });


</script>
</body>
</html>